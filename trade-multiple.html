<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto Post Discord</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
      body {
      background-color: #1e1e1e;
      /* Tema gelap */
      color: #fff;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      }
      .card {
      background-color: #333;
      /* Warna latar belakang card */
      color: #fff;
      border: none;
      border-radius: 10px;
      padding: 20px;
      text-align: center;
      }
      #messageStatus {
      margin-bottom: 20px;
      overflow-y: auto;
      max-height: 150px;
      /* Batas tinggi untuk pesan sukses */
      }
      .success-counter {
      color: #27ae60;
      /* Warna untuk counter sukses */
      }
      .error-counter {
      color: #c0392b;
      /* Warna untuk counter error */
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="card">
        <h1 class="mb-2">Auto Post Trade</h1>
        <h6 class="mb-3" id="last_send">Last Sent: </h6>
        <div id="messageStatus"></div>
      </div>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const channels = [
          { channel_id: '1222147024955244554', name: 'Toy Cp', delayMinutes: 60 },
          // { channel_id: '1202877392624820285', name: 'Toy - Marketplace', delayMinutes: 61 },
          { channel_id: '1130967592232820827', name: 'CPS Server', delayMinutes: 11 },
          { channel_id: '1173287029606461560', name: 'Crap CP', delayMinutes: 60 },
          { channel_id: '1208601553552801812', name: 'Kfn Cp', delayMinutes: 30},
          { channel_id: '1130618760655544380', name: 'Buraa Cp', delayMinutes: 60}
        ];
      
        let successCounter = {}; // Object untuk menyimpan counter sukses
        let errorCounter = {}; // Object untuk menyimpan counter error
      
        function sendMessage(channel) {
          const messageStatus = document.getElementById('messageStatus');
          const statusMessage = document.createElement('p');
          statusMessage.classList.add('mb-0'); // Tambahkan margin bawah pada setiap pesan
      
          const delayText = `${channel.delayMinutes} mins`;
      
          statusMessage.innerHTML = `Sending message to ${channel.name}... (Delay: ${delayText})`;
          messageStatus.insertBefore(statusMessage, messageStatus.firstChild); // Tambahkan pesan baru di bagian atas
      
          const payload = JSON.stringify({
            content: `
              > # <a:flash29:1222666884399497338>TOY STORE<a:flash29:1222666884399497338> 
              > ----------------------------
              > # BUY? DM <@898406105762398239> <a:trustedseller:1222187904348983448> 
              > ## <a:estrela88:1222670967957094400> SELL LIST  <a:estrela88:1222670967957094400> 
              > ** <a:arrow:1098931051046379611>SELL <a:shinybgll:1159140074244546683> PASTI MURAH, RATE DM !! **
              > ** <a:arrow:1098931051046379611>SELL <a:shinybgl:1137213838513688576> PASTI MURAH, RATE DM !! **
              > ** <a:arrow:1098931051046379611>SELL <:Mray:1140501066811703366> IDR. 40.000 **
              > ** <a:arrow:1098931051046379611>SELL <a:igl:1135617667315802193> IDR. 14.000 **
              > ** <a:arrow:1098931051046379611>SELL <:lray:1117141975532060763> IDR. 3.000 **
              > # <a:estrela88:1222670967957094400> BUY LIST <a:estrela88:1222670967957094400> 
              > ** <a:arrow:1098931051046379611> BUY TONS <a:shinybgll:1159140074244546683> RATE TINGGI, DM !! **
              > ** <a:arrow:1098931051046379611> BUY TONS <a:shinybgl:1137213838513688576> RATE TINGGI, DM !! **
              > # <a:estrela88:1222670967957094400> PAYMENT <a:estrela88:1222670967957094400> 
              > ** <a:arrow:1098931051046379611> <:dana:1141687721736278066> DANA / <:gopay:1117142067819315250> GOPAY / <:shopeepay:1037736409773133864> SHOPEE PAY**
              > ** <a:arrow:1098931051046379611> üè¶ BANK / <:qris:1141687984551362660> QRIS [ALL PAYMENT NO TAX]**
              > # BUY? DM <@898406105762398239> <a:trustedseller:1222187904348983448>
              > **<a:arrow:1098931051046379611> IDR PAYMENT ONLY <a:indo:1213790198123470848> **
              > **<a:arrow:1098931051046379611> FAST RESPOND & DROP <a:verified:1176176963195510905>  **
              > **<a:arrow:1098931051046379611> ROLE GOD MAX <:god:1216550066626760784>**
              > # <a:flash29:1222666884399497338>TOY STORE<a:flash29:1222666884399497338>
              > ----------------------------
              > || Always giveaway, check my profile !! || <@898406105762398239>
            `
          });
      
          const url = `https://discord.com/api/v9/channels/${channel.channel_id}/messages`;
          const headers = {
            'Content-Type': 'application/json',
            'Authorization': 'ODk4NDA2MTA1NzYyMzk4MjM5.GOZ4Bh.Ys_COMmQus6EovL_B9qstCbWJm99XjxT5pLR2U'
          };
      
          const xhr = new XMLHttpRequest();
          xhr.open('POST', url, true);
          Object.keys(headers).forEach(key => xhr.setRequestHeader(key, headers[key]));
      
          xhr.onreadystatechange = function () {
            if (xhr.readyState === XMLHttpRequest.DONE) {
              if (xhr.status === 200) {
                successCounter[channel.channel_id] = (successCounter[channel.channel_id] || 0) + 1; // Tambahkan counter sukses
                statusMessage.innerHTML = `Successfully sent to <span style="color: #fff">${channel.name}</span> (Delay: ${delayText}) | <span style="color: #fff">x${successCounter[channel.channel_id]} times!</span>`;
                statusMessage.classList.add('success-counter'); // Tambahkan kelas untuk warna sukses
                updateLastSend(); // Memperbarui waktu terakhir pengiriman
              } else {
                errorCounter[channel.channel_id] = (errorCounter[channel.channel_id] || 0) + 1; // Tambahkan counter error
                statusMessage.innerHTML = `Error sending to <span style="color: #fff">${channel.name}</span> : ${xhr.status} (Delay: ${delayText}) | <span style="color: #fff">x${errorCounter[channel.channel_id]} times!</span>`;
                statusMessage.classList.add('error-counter'); // Tambahkan kelas untuk warna error
              }
            }
          };
      
          xhr.send(payload);
        }
      
        function updateLastSend() {
          const lastSendElement = document.getElementById('last_send');
          const currentDate = new Date();
          const options = { timeZone: 'Asia/Jakarta', hour12: false, day: '2-digit', month: '2-digit', hour: '2-digit', minute: '2-digit' };
          const formattedDate = currentDate.toLocaleString('en-US', options);
          lastSendElement.textContent = `Last Sent: ${formattedDate} WIB`;
        }
      
        channels.forEach(channel => {
          sendMessage(channel); // Mengirim pesan pertama kali
          setInterval(() => {
            sendMessage(channel); // Mengirim pesan secara berkala
          }, channel.delayMinutes * 60000); // Mengalikan menit dengan 60000 untuk mendapatkan nilai dalam milidetik
        });
      });
    </script>
  </body>
</html>